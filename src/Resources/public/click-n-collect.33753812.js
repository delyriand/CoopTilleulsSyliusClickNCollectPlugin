(()=>{"use strict";$((function(){var e=JSON.parse($("#calendar_config").text()),t=e.locale.includes("_")?e.locale.split("_")[0]:e.locale;$("input.click_n_collect_location").each((function(){var n=$(this).attr("id").match(/sylius_checkout_select_shipping_shipments_([0-9]+)_location/)[1],i=$('input[name="sylius_checkout_select_shipping[shipments]['+n+'][method]"]'),c=$("#sylius_checkout_select_shipping_shipments_"+n+"_location"),o=$("#sylius_checkout_select_shipping_shipments_"+n+"_collectionTime"),l=$('<div id="calendar_'+n+'"></div>'),s=null,r=new FullCalendar.Calendar(l[0],{nowIndicator:!0,plugins:["timeGrid"],defaultView:"timeGridFourDay",views:{timeGridFourDay:{type:"timeGrid",duration:{days:4},buttonText:"4 day"}},eventColor:e.unselectedBackgroundColor,eventRender:function(e){e.event.id.slice(0,19)===o.val().slice(0,19)&&_(e.el)},eventClick:function(e){o.val(e.event.start.toISOString()),_(e.el)},locale:t}),a=!1,u=[],d=$('<select name="sylius_checkout_select_shipping[shipments]['+n+'][location]"></select>').change((function(){var e=$(this).val();m(v(e)),f(e)})),h=$('<div id="location_address_'+n+'"></div>');function _(t){var n=$(t);s&&s.css("background-color",e.unselectedBackgroundColor).css("border-color",e.unselectedBackgroundColor),n.css("background-color",e.selectedBackgroundColor).css("border-color",e.selectedBackgroundColor),s=n}function v(e){return u.find((function(t){return t.code===e}))}function p(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;d.empty(),$.getJSON("/"+e.locale+"/click-n-collect/locations/"+t,(function(e){if(u=e,0===e.length)return d.hide(),h.hide(),void l.hide();d.append(e.map((function(e){return $("<option>").val(e.code).text(e.name)}))),n?d.val(n):n=d.val(),d.show(),f(n),m(v(n))}))}function m(e){h.text((e.street||"")+" "+(e.postcode||"")+" "+(e.city||"")+" "+(e.provinceCode||"")+" "+(e.provinceName||"")+" "+(e.countryCode||"")),h.show()}function f(t){r.removeAllEventSources(),r.addEventSource("/"+e.locale+"/click-n-collect/collection-times/"+e.shipmentID+"/"+t),l.show(),a||(r.render(),a=!0)}d.hide().insertBefore(c),c.remove(),h.hide().insertAfter(d),l.hide().insertAfter(h),p(i.filter(":checked").val(),c.val()),i.change((function(){p($(this).val())}))}));var n=$('form[name="sylius_checkout_select_shipping"]')[0];n.onsubmit=function(t){$(n).serializeArray().filter((function(e,t,n){var i=e.name.match(/sylius_checkout_select_shipping\[shipments\]\[(\d+)\]\[collectionTime\]/);if(!i)return!1;var c=i[1],o=n.find((function(e){return e.name==="sylius_checkout_select_shipping[shipments]["+c+"][method]"}));return o&&"click_n_collect"===o.value})).every((function(e){return!!e.value}))||(t.preventDefault(),$(n).removeClass("loading"),alert(e.messages.noSlotSelected))}}))})();